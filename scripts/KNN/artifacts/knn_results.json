{
  "config": {
    "random_state": 42,
    "val_size": 0.2,
    "k_values": [
      1,
      3,
      5,
      7,
      9,
      11,
      13,
      15,
      17,
      19,
      20,
      21
    ],
    "cv_splits": 5,
    "pos_label": 5,
    "distances": [
      "euclidean",
      "manhattan"
    ]
  },
  "experiments": {
    "full_features": {
      "dataset": "full_features",
      "features": [
        "FCVC",
        "FAF",
        "CH2O",
        "NCP",
        "TUE",
        "MTRANS"
      ],
      "data_summary": {
        "train_val_samples": 475,
        "test_samples": 119,
        "train_val_class_counts": {
          "5": 238,
          "4": 237
        },
        "test_class_counts": {
          "4": 60,
          "5": 59
        },
        "train_size": 380,
        "val_size": 95
      },
      "best_hyperparams": {
        "k": 1,
        "distance": "euclidean",
        "validation_metrics": {
          "accuracy": 0.9263157894736842,
          "precision": 0.9019607843137255,
          "recall": 0.9583333333333334,
          "f1": 0.9292929292929293
        }
      },
      "validation": {
        "per_k": [
          {
            "accuracy": 0.9263157894736842,
            "precision": 0.9019607843137255,
            "recall": 0.9583333333333334,
            "f1": 0.9292929292929293,
            "k": 1,
            "distance": "euclidean"
          },
          {
            "accuracy": 0.8947368421052632,
            "precision": 0.8653846153846154,
            "recall": 0.9375,
            "f1": 0.9,
            "k": 3,
            "distance": "euclidean"
          },
          {
            "accuracy": 0.9052631578947369,
            "precision": 0.8679245283018868,
            "recall": 0.9583333333333334,
            "f1": 0.9108910891089109,
            "k": 5,
            "distance": "euclidean"
          },
          {
            "accuracy": 0.8842105263157894,
            "precision": 0.8245614035087719,
            "recall": 0.9791666666666666,
            "f1": 0.8952380952380953,
            "k": 7,
            "distance": "euclidean"
          },
          {
            "accuracy": 0.8421052631578947,
            "precision": 0.7796610169491526,
            "recall": 0.9583333333333334,
            "f1": 0.8598130841121495,
            "k": 9,
            "distance": "euclidean"
          },
          {
            "accuracy": 0.8421052631578947,
            "precision": 0.7796610169491526,
            "recall": 0.9583333333333334,
            "f1": 0.8598130841121495,
            "k": 11,
            "distance": "euclidean"
          },
          {
            "accuracy": 0.8210526315789474,
            "precision": 0.7719298245614035,
            "recall": 0.9166666666666666,
            "f1": 0.8380952380952381,
            "k": 13,
            "distance": "euclidean"
          },
          {
            "accuracy": 0.7894736842105263,
            "precision": 0.7333333333333333,
            "recall": 0.9166666666666666,
            "f1": 0.8148148148148148,
            "k": 15,
            "distance": "euclidean"
          },
          {
            "accuracy": 0.8,
            "precision": 0.7543859649122807,
            "recall": 0.8958333333333334,
            "f1": 0.819047619047619,
            "k": 17,
            "distance": "euclidean"
          },
          {
            "accuracy": 0.7894736842105263,
            "precision": 0.7413793103448276,
            "recall": 0.8958333333333334,
            "f1": 0.8113207547169812,
            "k": 19,
            "distance": "euclidean"
          },
          {
            "accuracy": 0.8,
            "precision": 0.7636363636363637,
            "recall": 0.875,
            "f1": 0.8155339805825242,
            "k": 20,
            "distance": "euclidean"
          },
          {
            "accuracy": 0.8,
            "precision": 0.7543859649122807,
            "recall": 0.8958333333333334,
            "f1": 0.819047619047619,
            "k": 21,
            "distance": "euclidean"
          },
          {
            "accuracy": 0.9157894736842105,
            "precision": 0.9,
            "recall": 0.9375,
            "f1": 0.9183673469387755,
            "k": 1,
            "distance": "manhattan"
          },
          {
            "accuracy": 0.9052631578947369,
            "precision": 0.8679245283018868,
            "recall": 0.9583333333333334,
            "f1": 0.9108910891089109,
            "k": 3,
            "distance": "manhattan"
          },
          {
            "accuracy": 0.9157894736842105,
            "precision": 0.8846153846153846,
            "recall": 0.9583333333333334,
            "f1": 0.92,
            "k": 5,
            "distance": "manhattan"
          },
          {
            "accuracy": 0.8947368421052632,
            "precision": 0.8518518518518519,
            "recall": 0.9583333333333334,
            "f1": 0.9019607843137255,
            "k": 7,
            "distance": "manhattan"
          },
          {
            "accuracy": 0.8947368421052632,
            "precision": 0.8518518518518519,
            "recall": 0.9583333333333334,
            "f1": 0.9019607843137255,
            "k": 9,
            "distance": "manhattan"
          },
          {
            "accuracy": 0.8631578947368421,
            "precision": 0.8181818181818182,
            "recall": 0.9375,
            "f1": 0.8737864077669902,
            "k": 11,
            "distance": "manhattan"
          },
          {
            "accuracy": 0.8315789473684211,
            "precision": 0.7962962962962963,
            "recall": 0.8958333333333334,
            "f1": 0.8431372549019608,
            "k": 13,
            "distance": "manhattan"
          },
          {
            "accuracy": 0.8,
            "precision": 0.7636363636363637,
            "recall": 0.875,
            "f1": 0.8155339805825242,
            "k": 15,
            "distance": "manhattan"
          },
          {
            "accuracy": 0.7789473684210526,
            "precision": 0.7368421052631579,
            "recall": 0.875,
            "f1": 0.8,
            "k": 17,
            "distance": "manhattan"
          },
          {
            "accuracy": 0.7894736842105263,
            "precision": 0.75,
            "recall": 0.875,
            "f1": 0.8076923076923077,
            "k": 19,
            "distance": "manhattan"
          },
          {
            "accuracy": 0.8105263157894737,
            "precision": 0.7884615384615384,
            "recall": 0.8541666666666666,
            "f1": 0.82,
            "k": 20,
            "distance": "manhattan"
          },
          {
            "accuracy": 0.8105263157894737,
            "precision": 0.7777777777777778,
            "recall": 0.875,
            "f1": 0.8235294117647058,
            "k": 21,
            "distance": "manhattan"
          }
        ],
        "best_confusion_matrix_path": "/Users/nojukas123/Documents/vscode/machine-learning-labs/scripts/KNN/artifacts/full_features/plots/validation_confusion_matrix.png",
        "metrics_csv": "/Users/nojukas123/Documents/vscode/machine-learning-labs/scripts/KNN/artifacts/full_features/validation_metrics_per_k.csv",
        "metrics_plot": "/Users/nojukas123/Documents/vscode/machine-learning-labs/scripts/KNN/artifacts/full_features/plots/validation_metrics_vs_k.png"
      },
      "cross_validation": {
        "accuracy_mean": 0.8800000000000001,
        "accuracy_std": 0.025437991523356986,
        "precision_mean": 0.8678137526981191,
        "precision_std": 0.03660391277316795,
        "recall_mean": 0.8990248226950355,
        "recall_std": 0.03137145679424674,
        "f1_mean": 0.8825249159401565,
        "f1_std": 0.024804187344712833
      },
      "test": {
        "metrics": {
          "accuracy": 0.8403361344537815,
          "precision": 0.8333333333333334,
          "recall": 0.847457627118644,
          "f1": 0.8403361344537815
        },
        "confusion_matrix": [
          [
            50,
            10
          ],
          [
            9,
            50
          ]
        ],
        "roc_curve": {
          "fpr": [
            0.0,
            0.16666666666666666,
            1.0
          ],
          "tpr": [
            0.0,
            0.847457627118644,
            1.0
          ],
          "auc": 0.8403954802259886
        },
        "plots": {
          "confusion_matrix": "/Users/nojukas123/Documents/vscode/machine-learning-labs/scripts/KNN/artifacts/full_features/plots/full_test_confusion_matrix.png",
          "roc_curve": "/Users/nojukas123/Documents/vscode/machine-learning-labs/scripts/KNN/artifacts/full_features/plots/full_test_roc_curve.png"
        }
      },
      "error_analysis": {
        "total_misclassified": 19,
        "fraction_near_boundary_prob_0.4_0.6": 0.0,
        "false_positive": {
          "count": 10,
          "top_feature_deviations": [
            {
              "feature": "NCP",
              "shift_vs_class_mean": 0.1707366666666666
            },
            {
              "feature": "CH2O",
              "shift_vs_class_mean": -0.08116666666666661
            },
            {
              "feature": "MTRANS",
              "shift_vs_class_mean": 0.054166666666666585
            }
          ],
          "examples": [
            {
              "FCVC": 0.91,
              "FAF": 0.4967,
              "CH2O": 0.495,
              "NCP": 0.6667,
              "TUE": 0.0,
              "MTRANS": 1.0,
              "true_label": 4,
              "pred_label": 5,
              "pred_proba_pos": 1.0,
              "index": 4
            },
            {
              "FCVC": 0.165,
              "FAF": 0.1067,
              "CH2O": 0.44,
              "NCP": 0.6667,
              "TUE": 0.0,
              "MTRANS": 0.75,
              "true_label": 4,
              "pred_label": 5,
              "pred_proba_pos": 1.0,
              "index": 32
            },
            {
              "FCVC": 0.5,
              "FAF": 0.0,
              "CH2O": 0.5,
              "NCP": 0.6667,
              "TUE": 0.465,
              "MTRANS": 1.0,
              "true_label": 4,
              "pred_label": 5,
              "pred_proba_pos": 1.0,
              "index": 38
            },
            {
              "FCVC": 0.835,
              "FAF": 0.2967,
              "CH2O": 0.085,
              "NCP": 0.6667,
              "TUE": 0.625,
              "MTRANS": 1.0,
              "true_label": 4,
              "pred_label": 5,
              "pred_proba_pos": 1.0,
              "index": 49
            },
            {
              "FCVC": 0.5,
              "FAF": 0.6033,
              "CH2O": 0.51,
              "NCP": 0.6667,
              "TUE": 0.535,
              "MTRANS": 1.0,
              "true_label": 4,
              "pred_label": 5,
              "pred_proba_pos": 1.0,
              "index": 87
            }
          ]
        },
        "false_negative": {
          "count": 9,
          "top_feature_deviations": [
            {
              "feature": "MTRANS",
              "shift_vs_class_mean": -0.1271186440677966
            },
            {
              "feature": "CH2O",
              "shift_vs_class_mean": 0.11580979284369114
            },
            {
              "feature": "NCP",
              "shift_vs_class_mean": 0.07867099811676082
            }
          ],
          "examples": [
            {
              "FCVC": 0.56,
              "FAF": 0.33,
              "CH2O": 0.595,
              "NCP": 0.6667,
              "TUE": 0.78,
              "MTRANS": 0.75,
              "true_label": 5,
              "pred_label": 4,
              "pred_proba_pos": 0.0,
              "index": 45
            },
            {
              "FCVC": 0.615,
              "FAF": 0.2867,
              "CH2O": 0.515,
              "NCP": 0.6633,
              "TUE": 0.225,
              "MTRANS": 1.0,
              "true_label": 5,
              "pred_label": 4,
              "pred_proba_pos": 0.0,
              "index": 47
            },
            {
              "FCVC": 0.52,
              "FAF": 0.3533,
              "CH2O": 0.06,
              "NCP": 0.6667,
              "TUE": 0.0,
              "MTRANS": 1.0,
              "true_label": 5,
              "pred_label": 4,
              "pred_proba_pos": 0.0,
              "index": 62
            },
            {
              "FCVC": 0.395,
              "FAF": 0.2233,
              "CH2O": 0.485,
              "NCP": 0.97,
              "TUE": 0.0,
              "MTRANS": 0.75,
              "true_label": 5,
              "pred_label": 4,
              "pred_proba_pos": 0.0,
              "index": 65
            },
            {
              "FCVC": 0.525,
              "FAF": 0.3567,
              "CH2O": 0.91,
              "NCP": 0.6667,
              "TUE": 0.0,
              "MTRANS": 1.0,
              "true_label": 5,
              "pred_label": 4,
              "pred_proba_pos": 0.0,
              "index": 66
            }
          ]
        },
        "csv_path": "/Users/nojukas123/Documents/vscode/machine-learning-labs/scripts/KNN/artifacts/full_features/misclassified_indices.csv"
      },
      "artifacts": {
        "plots_dir": "/Users/nojukas123/Documents/vscode/machine-learning-labs/scripts/KNN/artifacts/full_features/plots",
        "boundary_plot_train": "/Users/nojukas123/Documents/vscode/machine-learning-labs/scripts/KNN/artifacts/full_features/plots/decision_boundary_fcvc_faf_trainval.png",
        "boundary_plot_test": "/Users/nojukas123/Documents/vscode/machine-learning-labs/scripts/KNN/artifacts/full_features/plots/decision_boundary_fcvc_faf_test.png"
      }
    },
    "tsne_2d": {
      "dataset": "tsne_2d",
      "features": [
        "tsne_1",
        "tsne_2"
      ],
      "data_summary": {
        "train_val_samples": 475,
        "test_samples": 119,
        "train_val_class_counts": {
          "5": 238,
          "4": 237
        },
        "test_class_counts": {
          "4": 60,
          "5": 59
        },
        "train_size": 380,
        "val_size": 95
      },
      "best_hyperparams": {
        "k": 3,
        "distance": "euclidean",
        "validation_metrics": {
          "accuracy": 0.9052631578947369,
          "precision": 0.8823529411764706,
          "recall": 0.9375,
          "f1": 0.9090909090909091
        }
      },
      "validation": {
        "per_k": [
          {
            "accuracy": 0.8736842105263158,
            "precision": 0.86,
            "recall": 0.8958333333333334,
            "f1": 0.8775510204081632,
            "k": 1,
            "distance": "euclidean"
          },
          {
            "accuracy": 0.9052631578947369,
            "precision": 0.8823529411764706,
            "recall": 0.9375,
            "f1": 0.9090909090909091,
            "k": 3,
            "distance": "euclidean"
          },
          {
            "accuracy": 0.8947368421052632,
            "precision": 0.88,
            "recall": 0.9166666666666666,
            "f1": 0.8979591836734694,
            "k": 5,
            "distance": "euclidean"
          },
          {
            "accuracy": 0.8842105263157894,
            "precision": 0.8627450980392157,
            "recall": 0.9166666666666666,
            "f1": 0.8888888888888888,
            "k": 7,
            "distance": "euclidean"
          },
          {
            "accuracy": 0.8421052631578947,
            "precision": 0.8113207547169812,
            "recall": 0.8958333333333334,
            "f1": 0.8514851485148515,
            "k": 9,
            "distance": "euclidean"
          },
          {
            "accuracy": 0.8421052631578947,
            "precision": 0.8,
            "recall": 0.9166666666666666,
            "f1": 0.8543689320388349,
            "k": 11,
            "distance": "euclidean"
          },
          {
            "accuracy": 0.8421052631578947,
            "precision": 0.7894736842105263,
            "recall": 0.9375,
            "f1": 0.8571428571428571,
            "k": 13,
            "distance": "euclidean"
          },
          {
            "accuracy": 0.8210526315789474,
            "precision": 0.7719298245614035,
            "recall": 0.9166666666666666,
            "f1": 0.8380952380952381,
            "k": 15,
            "distance": "euclidean"
          },
          {
            "accuracy": 0.8315789473684211,
            "precision": 0.7758620689655172,
            "recall": 0.9375,
            "f1": 0.8490566037735849,
            "k": 17,
            "distance": "euclidean"
          },
          {
            "accuracy": 0.8421052631578947,
            "precision": 0.7796610169491526,
            "recall": 0.9583333333333334,
            "f1": 0.8598130841121495,
            "k": 19,
            "distance": "euclidean"
          },
          {
            "accuracy": 0.8315789473684211,
            "precision": 0.7758620689655172,
            "recall": 0.9375,
            "f1": 0.8490566037735849,
            "k": 20,
            "distance": "euclidean"
          },
          {
            "accuracy": 0.8421052631578947,
            "precision": 0.7796610169491526,
            "recall": 0.9583333333333334,
            "f1": 0.8598130841121495,
            "k": 21,
            "distance": "euclidean"
          },
          {
            "accuracy": 0.8631578947368421,
            "precision": 0.8571428571428571,
            "recall": 0.875,
            "f1": 0.865979381443299,
            "k": 1,
            "distance": "manhattan"
          },
          {
            "accuracy": 0.8842105263157894,
            "precision": 0.8627450980392157,
            "recall": 0.9166666666666666,
            "f1": 0.8888888888888888,
            "k": 3,
            "distance": "manhattan"
          },
          {
            "accuracy": 0.9052631578947369,
            "precision": 0.8823529411764706,
            "recall": 0.9375,
            "f1": 0.9090909090909091,
            "k": 5,
            "distance": "manhattan"
          },
          {
            "accuracy": 0.8631578947368421,
            "precision": 0.8181818181818182,
            "recall": 0.9375,
            "f1": 0.8737864077669902,
            "k": 7,
            "distance": "manhattan"
          },
          {
            "accuracy": 0.8631578947368421,
            "precision": 0.8301886792452831,
            "recall": 0.9166666666666666,
            "f1": 0.8712871287128713,
            "k": 9,
            "distance": "manhattan"
          },
          {
            "accuracy": 0.8421052631578947,
            "precision": 0.7894736842105263,
            "recall": 0.9375,
            "f1": 0.8571428571428571,
            "k": 11,
            "distance": "manhattan"
          },
          {
            "accuracy": 0.8,
            "precision": 0.7636363636363637,
            "recall": 0.875,
            "f1": 0.8155339805825242,
            "k": 13,
            "distance": "manhattan"
          },
          {
            "accuracy": 0.8210526315789474,
            "precision": 0.7719298245614035,
            "recall": 0.9166666666666666,
            "f1": 0.8380952380952381,
            "k": 15,
            "distance": "manhattan"
          },
          {
            "accuracy": 0.8315789473684211,
            "precision": 0.7758620689655172,
            "recall": 0.9375,
            "f1": 0.8490566037735849,
            "k": 17,
            "distance": "manhattan"
          },
          {
            "accuracy": 0.8210526315789474,
            "precision": 0.7719298245614035,
            "recall": 0.9166666666666666,
            "f1": 0.8380952380952381,
            "k": 19,
            "distance": "manhattan"
          },
          {
            "accuracy": 0.8210526315789474,
            "precision": 0.7818181818181819,
            "recall": 0.8958333333333334,
            "f1": 0.8349514563106796,
            "k": 20,
            "distance": "manhattan"
          },
          {
            "accuracy": 0.8105263157894737,
            "precision": 0.7678571428571429,
            "recall": 0.8958333333333334,
            "f1": 0.8269230769230769,
            "k": 21,
            "distance": "manhattan"
          }
        ],
        "best_confusion_matrix_path": "/Users/nojukas123/Documents/vscode/machine-learning-labs/scripts/KNN/artifacts/tsne_2d/plots/validation_confusion_matrix.png",
        "metrics_csv": "/Users/nojukas123/Documents/vscode/machine-learning-labs/scripts/KNN/artifacts/tsne_2d/validation_metrics_per_k.csv",
        "metrics_plot": "/Users/nojukas123/Documents/vscode/machine-learning-labs/scripts/KNN/artifacts/tsne_2d/plots/validation_metrics_vs_k.png"
      },
      "cross_validation": {
        "accuracy_mean": 0.8673684210526315,
        "accuracy_std": 0.03560323057955321,
        "precision_mean": 0.8485054035524099,
        "precision_std": 0.042828779614466135,
        "recall_mean": 0.898936170212766,
        "recall_std": 0.06601664105764835,
        "f1_mean": 0.8709410094816329,
        "f1_std": 0.036291713760596256
      },
      "test": {
        "metrics": {
          "accuracy": 0.5546218487394958,
          "precision": 0.5483870967741935,
          "recall": 0.576271186440678,
          "f1": 0.5619834710743802
        },
        "confusion_matrix": [
          [
            32,
            28
          ],
          [
            25,
            34
          ]
        ],
        "roc_curve": {
          "fpr": [
            0.0,
            0.3333333333333333,
            0.4666666666666667,
            0.75,
            1.0
          ],
          "tpr": [
            0.0,
            0.22033898305084745,
            0.576271186440678,
            0.8983050847457628,
            1.0
          ],
          "auc": 0.5360169491525424
        },
        "plots": {
          "confusion_matrix": "/Users/nojukas123/Documents/vscode/machine-learning-labs/scripts/KNN/artifacts/tsne_2d/plots/tsne_2d_test_confusion_matrix.png",
          "roc_curve": "/Users/nojukas123/Documents/vscode/machine-learning-labs/scripts/KNN/artifacts/tsne_2d/plots/tsne_2d_test_roc_curve.png"
        }
      },
      "error_analysis": {
        "total_misclassified": 53,
        "fraction_near_boundary_prob_0.4_0.6": 0.0,
        "false_positive": {
          "count": 28,
          "top_feature_deviations": [
            {
              "feature": "tsne_1",
              "shift_vs_class_mean": 3.0963634274761906
            },
            {
              "feature": "tsne_2",
              "shift_vs_class_mean": 0.20213836983333328
            }
          ],
          "examples": [
            {
              "tsne_1": 5.151041,
              "tsne_2": -1.3055637,
              "true_label": 4,
              "pred_label": 5,
              "pred_proba_pos": 1.0,
              "index": 0
            },
            {
              "tsne_1": 0.28502968,
              "tsne_2": 2.0193386,
              "true_label": 4,
              "pred_label": 5,
              "pred_proba_pos": 0.6666666666666666,
              "index": 7
            },
            {
              "tsne_1": 3.9243417,
              "tsne_2": -0.35817394,
              "true_label": 4,
              "pred_label": 5,
              "pred_proba_pos": 1.0,
              "index": 9
            },
            {
              "tsne_1": 5.1405997,
              "tsne_2": -0.083939664,
              "true_label": 4,
              "pred_label": 5,
              "pred_proba_pos": 1.0,
              "index": 20
            },
            {
              "tsne_1": -3.9254656,
              "tsne_2": -1.5340416,
              "true_label": 4,
              "pred_label": 5,
              "pred_proba_pos": 1.0,
              "index": 28
            }
          ]
        },
        "false_negative": {
          "count": 25,
          "top_feature_deviations": [
            {
              "feature": "tsne_1",
              "shift_vs_class_mean": -1.3734863047932215
            },
            {
              "feature": "tsne_2",
              "shift_vs_class_mean": 0.3561949203457626
            }
          ],
          "examples": [
            {
              "tsne_1": -2.28666,
              "tsne_2": 1.3608295,
              "true_label": 5,
              "pred_label": 4,
              "pred_proba_pos": 0.3333333333333333,
              "index": 1
            },
            {
              "tsne_1": -0.5576185,
              "tsne_2": -2.774807,
              "true_label": 5,
              "pred_label": 4,
              "pred_proba_pos": 0.3333333333333333,
              "index": 3
            },
            {
              "tsne_1": -8.350641,
              "tsne_2": 1.1206667,
              "true_label": 5,
              "pred_label": 4,
              "pred_proba_pos": 0.0,
              "index": 5
            },
            {
              "tsne_1": -3.2828999,
              "tsne_2": 2.7784405,
              "true_label": 5,
              "pred_label": 4,
              "pred_proba_pos": 0.3333333333333333,
              "index": 14
            },
            {
              "tsne_1": -6.1691008,
              "tsne_2": 1.3742884,
              "true_label": 5,
              "pred_label": 4,
              "pred_proba_pos": 0.0,
              "index": 15
            }
          ]
        },
        "csv_path": "/Users/nojukas123/Documents/vscode/machine-learning-labs/scripts/KNN/artifacts/tsne_2d/misclassified_indices.csv"
      },
      "artifacts": {
        "plots_dir": "/Users/nojukas123/Documents/vscode/machine-learning-labs/scripts/KNN/artifacts/tsne_2d/plots",
        "boundary_plot_train": "/Users/nojukas123/Documents/vscode/machine-learning-labs/scripts/KNN/artifacts/tsne_2d/plots/decision_boundary_tsne_trainval.png",
        "boundary_plot_test": "/Users/nojukas123/Documents/vscode/machine-learning-labs/scripts/KNN/artifacts/tsne_2d/plots/decision_boundary_tsne_test.png"
      }
    }
  }
}